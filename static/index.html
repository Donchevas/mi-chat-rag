<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Chat ¬∑ Base de Conocimiento</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Segoe UI', system-ui, sans-serif;
      background: #0f1117; color: #e8eaf0;
      height: 100vh; display: flex; flex-direction: column; align-items: center;
    }
    header {
      width: 100%; max-width: 800px; padding: 20px 24px 12px;
      display: flex; align-items: center; gap: 12px;
      border-bottom: 1px solid #1e2130;
    }
    .logo {
      width: 36px; height: 36px;
      background: linear-gradient(135deg, #4f8ef7, #9b5de5);
      border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 18px;
    }
    header h1 { font-size: 16px; font-weight: 600; color: #c8ccd8; }
    header span { font-size: 12px; color: #555c75; margin-left: auto; }
    #chat-container {
      flex: 1; width: 100%; max-width: 800px;
      overflow-y: auto; padding: 24px 16px;
      display: flex; flex-direction: column; gap: 20px; scroll-behavior: smooth;
    }
    .message { display: flex; gap: 12px; animation: fadeIn 0.25s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }
    .message.user { flex-direction: row-reverse; }
    .avatar {
      width: 32px; height: 32px; border-radius: 50%;
      display: flex; align-items: center; justify-content: center; font-size: 14px; flex-shrink: 0;
    }
    .message.user .avatar { background: #2a3a5c; }
    .message.assistant .avatar { background: linear-gradient(135deg, #4f8ef7, #9b5de5); }
    .bubble {
      max-width: 72%; padding: 12px 16px; border-radius: 16px;
      font-size: 14px; line-height: 1.65; white-space: pre-wrap;
    }
    .message.user .bubble { background: #1c2a4a; border-bottom-right-radius: 4px; color: #c8d8f8; }
    .message.assistant .bubble { background: #1a1d2e; border-bottom-left-radius: 4px; color: #dde1ef; }
    .typing span {
      display: inline-block; width: 7px; height: 7px; border-radius: 50%;
      background: #4f8ef7; margin: 0 2px; animation: bounce 1.2s infinite;
    }
    .typing span:nth-child(2) { animation-delay: 0.2s; }
    .typing span:nth-child(3) { animation-delay: 0.4s; }
    @keyframes bounce { 0%, 80%, 100% { transform: translateY(0); } 40% { transform: translateY(-6px); } }
    #input-area { width: 100%; max-width: 800px; padding: 16px; border-top: 1px solid #1e2130; }
    #input-wrapper {
      display: flex; gap: 10px; background: #1a1d2e;
      border: 1px solid #2a2f45; border-radius: 14px; padding: 10px 14px; transition: border-color 0.2s;
    }
    #input-wrapper:focus-within { border-color: #4f8ef7; }
    textarea {
      flex: 1; background: transparent; border: none; outline: none;
      color: #e8eaf0; font-size: 14px; resize: none; max-height: 120px; font-family: inherit; line-height: 1.5;
    }
    textarea::placeholder { color: #404560; }
    button {
      background: linear-gradient(135deg, #4f8ef7, #9b5de5);
      border: none; border-radius: 9px; width: 36px; height: 36px;
      cursor: pointer; display: flex; align-items: center; justify-content: center; flex-shrink: 0; transition: opacity 0.2s;
    }
    button:disabled { opacity: 0.4; cursor: not-allowed; }
    button:not(:disabled):hover { opacity: 0.85; }
    .hint { text-align: center; font-size: 11px; color: #333750; margin-top: 8px; }
    #chat-container::-webkit-scrollbar { width: 5px; }
    #chat-container::-webkit-scrollbar-track { background: transparent; }
    #chat-container::-webkit-scrollbar-thumb { background: #2a2f45; border-radius: 10px; }
    .welcome { text-align: center; padding: 48px 24px; color: #3a4060; }
    .welcome h2 { font-size: 22px; margin-bottom: 8px; color: #5a6080; }
    .welcome p { font-size: 14px; }
  </style>
</head>
<body>
<header>
  <div class="logo">üß†</div>
  <h1>Base de Conocimiento</h1>
  <span>Nexus v2</span>
</header>
<div id="chat-container">
  <div class="welcome">
    <h2>Hola, ¬øen qu√© puedo ayudarte?</h2>
    <p>Haz una pregunta sobre los documentos cargados en tu base de conocimiento.</p>
  </div>
</div>
<div id="input-area">
  <div id="input-wrapper">
    <textarea id="user-input" rows="1" placeholder="Escribe tu pregunta..."></textarea>
    <button id="send-btn" title="Enviar">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
        <line x1="22" y1="2" x2="11" y2="13"></line>
        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
      </svg>
    </button>
  </div>
  <p class="hint">Enter para enviar ¬∑ Shift+Enter para nueva l√≠nea</p>
</div>
<script>
  const chatContainer = document.getElementById('chat-container');
  const userInput = document.getElementById('user-input');
  const sendBtn = document.getElementById('send-btn');
  let history = [];
  let isLoading = false;

  userInput.addEventListener('input', () => {
    userInput.style.height = 'auto';
    userInput.style.height = Math.min(userInput.scrollHeight, 120) + 'px';
  });
  userInput.addEventListener('keydown', (e) => {
    if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendMessage(); }
  });
  sendBtn.addEventListener('click', sendMessage);

  function addMessage(role, text) {
    const welcome = chatContainer.querySelector('.welcome');
    if (welcome) welcome.remove();
    const div = document.createElement('div');
    div.className = `message ${role}`;
    const avatar = document.createElement('div');
    avatar.className = 'avatar';
    avatar.textContent = role === 'user' ? 'üë§' : 'üß†';
    const bubble = document.createElement('div');
    bubble.className = 'bubble';
    bubble.textContent = text;
    div.appendChild(avatar);
    div.appendChild(bubble);
    chatContainer.appendChild(div);
    chatContainer.scrollTop = chatContainer.scrollHeight;
  }

  function showTyping() {
    const div = document.createElement('div');
    div.className = 'message assistant';
    div.id = 'typing-indicator';
    const avatar = document.createElement('div');
    avatar.className = 'avatar';
    avatar.textContent = 'üß†';
    const bubble = document.createElement('div');
    bubble.className = 'bubble typing';
    bubble.innerHTML = '<span></span><span></span><span></span>';
    div.appendChild(avatar);
    div.appendChild(bubble);
    chatContainer.appendChild(div);
    chatContainer.scrollTop = chatContainer.scrollHeight;
  }

  function hideTyping() {
    const t = document.getElementById('typing-indicator');
    if (t) t.remove();
  }

  async function sendMessage() {
    const text = userInput.value.trim();
    if (!text || isLoading) return;
    isLoading = true;
    sendBtn.disabled = true;
    userInput.value = '';
    userInput.style.height = 'auto';
    addMessage('user', text);
    showTyping();
    try {
      const res = await fetch('/chat', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ message: text, history })
      });
      hideTyping();
      if (!res.ok) {
        const err = await res.json().catch(() => ({}));
        addMessage('assistant', `‚ùå Error: ${err.detail || res.statusText}`);
      } else {
        const data = await res.json();
        addMessage('assistant', data.answer);
        history.push({ role: 'user', content: text });
        history.push({ role: 'model', content: data.answer });
        if (history.length > 20) history = history.slice(-20);
      }
    } catch (e) {
      hideTyping();
      addMessage('assistant', `‚ùå Error de conexi√≥n: ${e.message}`);
    }
    isLoading = false;
    sendBtn.disabled = false;
    userInput.focus();
  }
</script>
</body>
</html>
```

---

## Estructura de carpetas que debes crear
```
mi-chat-rag/
‚îú‚îÄ‚îÄ main.py
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ Dockerfile
‚îî‚îÄ‚îÄ static/
    ‚îî‚îÄ‚îÄ index.html